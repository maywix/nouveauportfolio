<section id="projets" class="container mx-auto px-6 py-20">
  <div class="max-w-6xl mx-auto">
    <div class="mb-12">
      <h2 class="text-3xl mb-4">Projets</h2>
      <p class="text-white/60 text-base">
        Sélection de réalisations organisées par discipline. Choisissez une
        catégorie pour explorer mes productions.
      </p>
    </div>

    <div class="flex flex-wrap gap-3 mb-12">
      <button
        *ngFor="let option of categoryOptions"
        type="button"
        class="px-6 py-2 rounded-full text-sm tracking-wide transition-all duration-200 border border-white/10"
        [ngClass]="
          activeCategory === option.value
            ? 'bg-accent text-primary shadow-lg shadow-accent/20'
            : 'bg-white/5 text-white/70 hover:bg-white/10'
        "
        (click)="selectCategory(option.value)"
      >
        {{ option.label }}
      </button>
    </div>

    <div *ngIf="activeCategory === 'video'" class="space-y-12">
      <div *ngFor="let section of videoSections" class="space-y-6">
        <h3 class="text-2xl">{{ section.title }}</h3>
        <div class="grid gap-8 md:grid-cols-2">
          <article
            *ngFor="let item of section.items"
            class="p-6 bg-white/5 border border-white/10 rounded-2xl backdrop-blur-sm flex flex-col gap-4"
          >
            <div class="aspect-video rounded-xl overflow-hidden bg-black/60">
              <iframe
                class="w-full h-full"
                frameborder="0"
                allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"
                allowfullscreen
                [src]="toSafeUrl(item.embedUrl)"
                title="YouTube placeholder"
              ></iframe>
            </div>
            <div>
              <h4 class="text-lg">{{ item.title }}</h4>
              <p class="text-white/70 text-sm leading-relaxed">
                {{ item.description }}
              </p>
            </div>
          </article>
        </div>
      </div>
    </div>

    <div *ngIf="activeCategory === 'graphic'" class="space-y-10">
      <div
        *ngFor="let carousel of graphicCarousels; let idx = index"
        class="p-6 bg-white/5 border border-white/10 rounded-2xl backdrop-blur-sm"
      >
        <div
          class="flex flex-col md:flex-row md:items-center md:justify-between gap-4 mb-6"
        >
          <h3 class="text-2xl">{{ carousel.title }}</h3>
          <div class="flex gap-3">
            <button
              type="button"
              class="carousel-nav"
              (click)="previousSlide('graphic', idx)"
            >
              ‹
            </button>
            <button
              type="button"
              class="carousel-nav"
              (click)="nextSlide('graphic', idx)"
            >
              ›
            </button>
          </div>
        </div>
        <div
          class="relative overflow-hidden rounded-xl bg-accent/5 p-6 min-h-[220px] flex flex-col justify-between"
        >
          <div>
            <p class="text-sm text-accent/70 uppercase tracking-[0.4em] mb-3">
              Slide {{ graphicIndices[idx] + 1 }} / {{ carousel.slides.length }}
            </p>
            <h4 class="text-xl mb-2">
              {{ getSlide("graphic", idx).title }}
            </h4>
            <p class="text-white/70 text-sm leading-relaxed">
              {{ getSlide("graphic", idx).description }}
            </p>
          </div>
          <span class="self-end text-xs text-white/40"
            >Moodboard &amp; maquettes</span
          >
        </div>
      </div>
    </div>

    <div *ngIf="activeCategory === 'threeD'" class="space-y-10">
      <div
        *ngFor="let carousel of threeDCarousels; let idx = index"
        class="p-6 bg-white/5 border border-white/10 rounded-2xl backdrop-blur-sm"
      >
        <div
          class="flex flex-col md:flex-row md:items-center md:justify-between gap-4 mb-6"
        >
          <h3 class="text-2xl">{{ carousel.title }}</h3>
          <div class="flex gap-3">
            <button
              type="button"
              class="carousel-nav"
              (click)="previousSlide('threeD', idx)"
            >
              ‹
            </button>
            <button
              type="button"
              class="carousel-nav"
              (click)="nextSlide('threeD', idx)"
            >
              ›
            </button>
          </div>
        </div>
        <div
          class="relative overflow-hidden rounded-xl bg-gradient-to-br from-white/10 via-white/5 to-white/0 p-6 min-h-[220px] flex flex-col justify-between"
        >
          <div>
            <p class="text-sm text-accent/70 uppercase tracking-[0.4em] mb-3">
              Slide {{ threeDIndices[idx] + 1 }} / {{ carousel.slides.length }}
            </p>
            <h4 class="text-xl mb-2">
              {{ getSlide("threeD", idx).title }}
            </h4>
            <p class="text-white/70 text-sm leading-relaxed">
              {{ getSlide("threeD", idx).description }}
            </p>
          </div>
          <span class="self-end text-xs text-white/40"
            >Rendus &amp; lighting</span
          >
        </div>
      </div>
    </div>

    <div *ngIf="activeCategory === 'web'" class="space-y-10">
      <div
        *ngFor="let carousel of webCarousels; let idx = index"
        class="p-6 bg-white/5 border border-white/10 rounded-2xl backdrop-blur-sm"
      >
        <div
          class="flex flex-col md:flex-row md:items-center md:justify-between gap-4 mb-6"
        >
          <h3 class="text-2xl">{{ carousel.title }}</h3>
          <div class="flex gap-3">
            <button
              type="button"
              class="carousel-nav"
              (click)="previousSlide('web', idx)"
            >
              ‹
            </button>
            <button
              type="button"
              class="carousel-nav"
              (click)="nextSlide('web', idx)"
            >
              ›
            </button>
          </div>
        </div>
        <div
          class="relative overflow-hidden rounded-xl bg-white/5 p-6 min-h-[220px] flex flex-col justify-between"
        >
          <div>
            <p class="text-sm text-accent/70 uppercase tracking-[0.4em] mb-3">
              Slide {{ webIndices[idx] + 1 }} / {{ carousel.slides.length }}
            </p>
            <h4 class="text-xl mb-2">
              {{ getSlide("web", idx).title }}
            </h4>
            <p class="text-white/70 text-sm leading-relaxed mb-4">
              {{ getSlide("web", idx).description }}
            </p>
          </div>
          <div class="flex justify-end">
            <a
              *ngIf="getSlide('web', idx).link as url"
              class="inline-flex items-center gap-2 bg-accent text-primary text-sm font-semibold px-4 py-2 rounded-full shadow-lg shadow-accent/20 transition-transform duration-200 hover:scale-105"
              [href]="url"
              target="_blank"
              rel="noopener noreferrer"
            >
              Voir le site
              <span aria-hidden="true">↗</span>
            </a>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>
