<section id="projets" class="container mx-auto px-6 py-20">
  <div class="max-w-7xl mx-auto">
    <div class="mb-12">
      <h2 class="text-3xl mb-4">Projets</h2>
      <p class="text-white/60 text-base">
        Sélection de réalisations organisées par discipline. Choisissez une
        catégorie pour explorer mes productions.
      </p>
    </div>

    <div class="flex flex-wrap gap-3 mb-12">
      <button
        *ngFor="let option of categoryOptions"
        type="button"
        class="projects-filter"
        [ngClass]="
          activeCategory === option.value
            ? 'projects-filter--active'
            : 'projects-filter--idle'
        "
        (click)="selectCategory(option.value)"
      >
        {{ option.label }}
      </button>
    </div>

    <div *ngIf="activeCategory === 'video'" class="space-y-12">
      <div *ngFor="let section of videoSections" class="space-y-6">
        <h3 class="text-2xl">{{ section.title }}</h3>
        <div class="grid gap-8 md:grid-cols-2">
          <article
            *ngFor="let item of section.items"
            class="p-6 bg-white/5 border border-white/10 rounded-2xl backdrop-blur-sm flex flex-col gap-4"
          >
            <div class="aspect-video rounded-xl overflow-hidden bg-black/60">
              <iframe
                class="w-full h-full"
                frameborder="0"
                allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"
                allowfullscreen
                [src]="toSafeUrl(item.embedUrl)"
                title="YouTube placeholder"
              ></iframe>
            </div>
            <div>
              <h4 class="text-lg">{{ item.title }}</h4>
              <p class="text-white/70 text-sm leading-relaxed">
                {{ item.description }}
              </p>
            </div>
          </article>
        </div>
      </div>
    </div>

    <div *ngIf="activeCategory === 'graphic'" class="space-y-10">
      <div
        *ngFor="let carousel of graphicCarousels; let idx = index"
        class="projects-panel"
      >
        <div class="projects-panel__header">
          <h3 class="projects-panel__title">{{ carousel.title }}</h3>
          <div class="projects-panel__controls">
            <button
              type="button"
              class="projects-nav"
              [class.projects-nav--disabled]="!canGoPrev('graphic', idx)"
              [disabled]="!canGoPrev('graphic', idx)"
              aria-label="Voir le projet précédent"
              (click)="previousSlide('graphic', idx)"
            >
              ‹
            </button>
            <button
              type="button"
              class="projects-nav"
              [class.projects-nav--disabled]="!canGoNext('graphic', idx)"
              [disabled]="!canGoNext('graphic', idx)"
              aria-label="Voir le projet suivant"
              (click)="nextSlide('graphic', idx)"
            >
              ›
            </button>
          </div>
        </div>

        <div class="projects-carousel">
          <div
            *ngFor="let slide of carousel.slides; let slideIndex = index"
            class="project-card-container"
            [ngStyle]="getCarouselStyles('graphic', idx, slideIndex)"
          >
            <article class="project-card">
              <p class="project-card__index">
                {{ slideIndex + 1 }} / {{ carousel.slides.length }}
              </p>
              <h4 class="project-card__title">{{ slide.title }}</h4>
              <p class="project-card__description">
                {{ slide.description }}
              </p>
              <span class="project-card__tag">Moodboard &amp; maquettes</span>
            </article>
          </div>
        </div>
      </div>
    </div>

    <div *ngIf="activeCategory === 'threeD'" class="space-y-10">
      <div
        *ngFor="let carousel of threeDCarousels; let idx = index"
        class="projects-panel"
      >
        <div class="projects-panel__header">
          <h3 class="projects-panel__title">{{ carousel.title }}</h3>
          <div class="projects-panel__controls">
            <button
              type="button"
              class="projects-nav"
              [class.projects-nav--disabled]="!canGoPrev('threeD', idx)"
              [disabled]="!canGoPrev('threeD', idx)"
              aria-label="Voir le projet précédent"
              (click)="previousSlide('threeD', idx)"
            >
              ‹
            </button>
            <button
              type="button"
              class="projects-nav"
              [class.projects-nav--disabled]="!canGoNext('threeD', idx)"
              [disabled]="!canGoNext('threeD', idx)"
              aria-label="Voir le projet suivant"
              (click)="nextSlide('threeD', idx)"
            >
              ›
            </button>
          </div>
        </div>

        <div class="projects-carousel">
          <div
            *ngFor="let slide of carousel.slides; let slideIndex = index"
            class="project-card-container"
            [ngStyle]="getCarouselStyles('threeD', idx, slideIndex)"
          >
            <article class="project-card project-card--gradient">
              <p class="project-card__index">
                {{ slideIndex + 1 }} / {{ carousel.slides.length }}
              </p>
              <h4 class="project-card__title">{{ slide.title }}</h4>
              <p class="project-card__description">
                {{ slide.description }}
              </p>
              <span class="project-card__tag">Rendus &amp; lighting</span>
            </article>
          </div>
        </div>
      </div>
    </div>

    <div *ngIf="activeCategory === 'web'" class="space-y-10">
      <div
        *ngFor="let carousel of webCarousels; let idx = index"
        class="projects-panel"
      >
        <div class="projects-panel__header">
          <h3 class="projects-panel__title">{{ carousel.title }}</h3>
          <div class="projects-panel__controls">
            <button
              type="button"
              class="projects-nav"
              [class.projects-nav--disabled]="!canGoPrev('web', idx)"
              [disabled]="!canGoPrev('web', idx)"
              aria-label="Voir le projet précédent"
              (click)="previousSlide('web', idx)"
            >
              ‹
            </button>
            <button
              type="button"
              class="projects-nav"
              [class.projects-nav--disabled]="!canGoNext('web', idx)"
              [disabled]="!canGoNext('web', idx)"
              aria-label="Voir le projet suivant"
              (click)="nextSlide('web', idx)"
            >
              ›
            </button>
          </div>
        </div>

        <div class="projects-carousel">
          <div
            *ngFor="let slide of carousel.slides; let slideIndex = index"
            class="project-card-container"
            [ngStyle]="getCarouselStyles('web', idx, slideIndex)"
          >
            <article class="project-card">
              <p class="project-card__index">
                {{ slideIndex + 1 }} / {{ carousel.slides.length }}
              </p>
              <h4 class="project-card__title">{{ slide.title }}</h4>
              <p class="project-card__description">
                {{ slide.description }}
              </p>
              <a
                *ngIf="slide.link && webIndices[idx] === slideIndex"
                class="project-card__link"
                [href]="slide.link"
                target="_blank"
                rel="noopener noreferrer"
              >
                Voir le site ↗
              </a>
            </article>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>
